# クイズ作成・実施アプリ 要件定義書

## 概要

本アプリケーションは、ユーザーがクイズセットを作成し、他のユーザーがそのクイズに挑戦できる Web アプリケーションです。クイズの成績は自動採点され、ランキング形式で表示されます。また、ユーザーはクイズセットを評価することができます。

## 用語集

- **クイズセット**: 複数の問題をまとめた単位。タイトル、説明、カテゴリを持つ
- **問題**: クイズセット内の個別の質問。選択肢と正解を持つ
- **チャレンジ**: ユーザーがクイズセットに挑戦した記録
- **スコア**: チャレンジの結果得られた点数
- **初回スコア**: 初めてそのクイズセットにチャレンジした時のスコア
- **公開状態**: クイズセットの公開/非公開の状態

## 機能要件

### FR-001: ユーザー認証

**目的:** ユーザーを識別し、クイズの作成者や回答者を管理する

**機能概要:**
ユーザーはアカウントを登録してログインすることで、クイズの作成や挑戦ができる。システムには事前に 2 つのテストアカウントが用意されている。

#### 1.1 ユーザー登録

新規ユーザーがアカウントを作成できる。

**制約条件（ユーザー登録固有）:**

- ユーザー名、メールアドレス、パスワードは必須
- メールアドレスは重複不可

#### 1.2 ログイン

登録済みユーザーがシステムにログインできる。

**制約条件（ログイン固有）:**

- メールアドレスとパスワードによる認証
- 認証失敗時はエラーメッセージを表示

#### 1.3 ログアウト

ログイン中のユーザーがログアウトできる。

#### 1.4 テストアカウント

システムには以下の 2 つのテストアカウントが事前に登録されている。

**制約条件（テストアカウント固有）:**

- テストアカウント 1: メールアドレス `test1@example.com`、ユーザー名 `テストユーザー1`
- テストアカウント 2: メールアドレス `test2@example.com`、ユーザー名 `テストユーザー2`
- テストアカウントのパスワードは `password123`

**制約条件（ユーザー認証全体）:**

- ログインしていないユーザーは、公開済みクイズセット一覧の閲覧のみ可能
- クイズの作成、編集、削除、挑戦にはログインが必須

---

### FR-002: クイズセット管理

**目的:** ユーザーがクイズセットを作成・管理し、学習コンテンツを提供する

**機能概要:**
ログインユーザーは複数の問題をまとめたクイズセットを作成できる。クイズセットにはタイトル、説明、カテゴリ、公開状態を設定し、作成者が管理する。

#### 2.1 クイズセット作成

ログインユーザーが新しいクイズセットを作成できる。

**制約条件（クイズセット作成固有）:**

- タイトルは必須
- 説明とカテゴリは任意
- 作成時点では問題は含まれていなくてもよい
- 作成時の初期状態は非公開

#### 2.2 クイズセット一覧表示

全てのユーザー（未ログインユーザー含む）が公開済みクイズセット一覧を閲覧できる。

**制約条件（クイズセット一覧表示固有）:**

- 各クイズセットのタイトル、作成者名、カテゴリ、問題数、平均評価、参加者数を表示
- 参加者数はそのクイズセットにチャレンジしたことがあるユニークなユーザー数
- カテゴリで絞り込みができる
- 非公開のクイズセットは一覧に表示されない
- 作成者は自分の非公開クイズセットも一覧で確認できる

#### 2.3 クイズセット詳細表示

全てのユーザーが公開済みクイズセットの詳細情報を閲覧できる。

**制約条件（クイズセット詳細表示固有）:**

- タイトル、説明、作成者名、カテゴリ、問題数、平均評価、参加者数、ランキングを表示
- 参加者数はそのクイズセットにチャレンジしたことがあるユニークなユーザー数
- 問題の内容は表示しない（チャレンジ開始後に表示）
- 非公開のクイズセットは作成者以外閲覧できない

#### 2.4 クイズセット編集

作成者のみが自分の作成したクイズセットを編集できる。

**制約条件（クイズセット編集固有）:**

- タイトル、説明、カテゴリの変更が可能
- 問題の編集は問題管理機能で行う

#### 2.5 クイズセット削除

作成者のみが自分の作成したクイズセットを削除できる。

**制約条件（クイズセット削除固有）:**

- クイズセットを削除すると、紐づく全ての問題も削除される
- 過去のチャレンジ記録は残る
- クイズセットに紐づく評価も削除される

#### 2.6 公開/非公開設定

作成者が自分のクイズセットの公開状態を切り替えられる。

**制約条件（公開/非公開設定固有）:**

- 公開状態は「公開」または「非公開」のいずれか
- 非公開のクイズセットは作成者以外アクセスできない
- 非公開のクイズセットは一覧に表示されない（作成者には表示）
- 非公開のクイズセットにはチャレンジできない（作成者を除く）

**制約条件（クイズセット管理全体）:**

- 作成者以外のユーザーは編集・削除・公開設定の変更ができない
- 未ログインユーザーはクイズセットの作成、編集、削除ができない

---

### FR-003: 問題管理

**目的:** クイズセット内の個別の問題を管理する

**機能概要:**
クイズセット作成者は、自分のクイズセットに問題を追加・編集・削除できる。各問題は 4 択形式で、正解を 1 つ指定する。

#### 3.1 問題追加

クイズセット作成者が自分のクイズセットに新しい問題を追加できる。

**制約条件（問題追加固有）:**

- 問題文は必須
- 選択肢は 4 つ必須
- 正解を 1 つ指定する必要がある

#### 3.2 問題一覧表示

クイズセット作成者が自分のクイズセット内の問題一覧を閲覧できる。

**制約条件（問題一覧表示固有）:**

- 問題文と正解を表示
- 編集・削除操作が可能

#### 3.3 問題編集

クイズセット作成者が自分のクイズセット内の問題を編集できる。

**制約条件（問題編集固有）:**

- 問題文、選択肢、正解の変更が可能

#### 3.4 問題削除

クイズセット作成者が自分のクイズセット内の問題を削除できる。

**制約条件（問題管理全体）:**

- クイズセット作成者以外は問題の追加、編集、削除ができない
- 問題が 1 つもないクイズセットも存在できる

---

### FR-004: クイズチャレンジ

**目的:** ユーザーがクイズに挑戦し、学習効果を得る

**機能概要:**
ログインユーザーは公開されているクイズセットに挑戦できる。全問題に回答後、自動採点され、スコアが記録される。初回チャレンジと 2 回目以降のチャレンジは区別して記録される。

#### 4.1 チャレンジ開始

ログインユーザーが公開済みクイズセットへのチャレンジを開始できる。

**制約条件（チャレンジ開始固有）:**

- 問題が 1 つ以上あるクイズセットのみチャレンジ可能
- チャレンジ開始時に問題が順次表示される
- 非公開のクイズセットは作成者のみチャレンジ可能

#### 4.2 回答入力

ユーザーが各問題に対して選択肢から 1 つを選択して回答できる。

**制約条件（回答入力固有）:**

- 各問題に対して 1 つの選択肢を選ぶ必要がある
- 全問題に回答するまでチャレンジは完了しない

#### 4.3 採点・結果表示

全問題への回答完了後、自動採点され、結果が表示される。

**制約条件（採点・結果表示固有）:**

- 正解数と総問題数を表示
- スコアは「正解数 / 総問題数 × 100」で算出（小数点以下切り捨て）
- 各問題の正誤と正解を表示

#### 4.4 スコア記録

チャレンジ完了後、スコアがユーザーの記録として保存される。

**制約条件（スコア記録固有）:**

- ユーザーは同じクイズセットに何度でも挑戦できる
- 各チャレンジのスコアは全て記録される
- 初回チャレンジのスコアは「初回スコア」として記録される
- 2 回目以降のチャレンジのスコアは「通常スコア」として記録される

**制約条件（クイズチャレンジ全体）:**

- 未ログインユーザーはチャレンジできない
- 自分が作成したクイズセットにも挑戦できる

---

### FR-005: スコア・ランキング表示

**目的:** ユーザーの学習成果を可視化し、競争意欲を促進する

**機能概要:**
ユーザーは自分のチャレンジ履歴を確認できる。各クイズセットごとに全ユーザーのランキングが表示される。ランキングには初回スコアのみが反映される。

#### 5.1 マイスコア表示

ログインユーザーが自分の全チャレンジ履歴を閲覧できる。

**制約条件（マイスコア表示固有）:**

- クイズセット名、スコア、チャレンジ日時、初回/通常の区別を表示
- 新しい順に並べて表示

#### 5.2 クイズセット別ランキング表示

全てのユーザーが各クイズセットのランキングを閲覧できる。

**制約条件（クイズセット別ランキング表示固有）:**

- クイズセット詳細画面にランキングが表示される
- 各ユーザーの初回スコアを集計
- スコアの高い順に上位 10 名を表示
- ユーザー名とスコアを表示
- 初回チャレンジをしていないユーザーはランキングに表示されない

**制約条件（スコア・ランキング表示全体）:**

- 同一スコアの場合は早くチャレンジしたユーザーを上位とする
- チャレンジ記録がないクイズセットはランキングが空
- 非公開のクイズセットのランキングは作成者のみ閲覧可能

---

### FR-006: 星評価機能

**目的:** ユーザーがクイズセットの品質を評価し、他のユーザーの選択を支援する

**機能概要:**
ログインユーザーは公開されているクイズセットに 5 段階の星評価を付けることができる。各クイズセットの平均評価が表示される。

#### 6.1 評価の投稿

ログインユーザーが公開済みクイズセットに星評価を付けることができる。

**制約条件（評価の投稿固有）:**

- 1 つのクイズセットに対して 1 ユーザー 1 回のみ評価可能
- 評価は 1〜5 の整数（星 1〜5）
- 自分が作成したクイズセットも評価できる

#### 6.2 評価の変更

ログインユーザーが自分が投稿した評価を変更できる。

**制約条件（評価の変更固有）:**

- 既に評価済みのクイズセットのみ変更可能
- 評価は 1〜5 の整数に変更

#### 6.3 評価の削除

ログインユーザーが自分が投稿した評価を削除できる。

#### 6.4 平均評価の表示

全てのユーザーが各クイズセットの平均評価を閲覧できる。

**制約条件（平均評価の表示固有）:**

- 平均評価は小数点第 1 位まで表示
- 評価が 1 件もない場合は「評価なし」と表示
- クイズセット一覧および詳細画面に表示

**制約条件（星評価機能全体）:**

- 未ログインユーザーは評価の投稿、変更、削除ができない
- 非公開のクイズセットは作成者のみ評価できる
- クイズセットが削除されると、紐づく全ての評価も削除される
